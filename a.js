const puppeteer = require('puppeteer');
let fs = require('fs');
const headers = { 'x-beserver': 'SN2PR00MB0093',
    'content-encoding': 'gzip',
    'x-backendhttpstatus': '200, 200',
    'x-proxy-backendserverstatus': '200',
    'x-feserver': 'SN2PR00CA0039, CY4PR00CA0007',
    status: '200',
    'x-rum-validated': '1',
    'x-feproxyinfo': 'SN2PR00CA0039.NAMPRD00.PROD.OUTLOOK.COM',
    'x-owa-minimumsupportedowsversion': 'V2_6',
    'request-id': 'fc002fe6-5d19-4ec9-a1c9-9a0013699bb4',
    'x-owa-dag': 'NAMPR00DG006',
    'x-calculatedbetarget': 'SN2PR00MB0093.namprd00.prod.outlook.com',
    vary: 'Accept-Encoding',
    'content-type': 'text/html',
    'cache-control': 'private',
    'x-diaginfo': 'SN2PR00MB0093',
    'x-besku': 'Gen9',
    'x-proxy-routingcorrectness': '1',
    date: 'Thu, 19 Dec 2019 01:39:46 GMT',
    'x-owa-version': '15.20.2597.0',
    'x-content-type-options': 'nosniff',
'x-owa-forest': 'namprd00.prod.outlook.com',
    'x-calculatedfetarget': 'SN2PR00CU001.internal.outlook.com',
    'x-backend-end': '2019-12-19T01:39:47.002',
    'x-mailboxguid': '29f6c9d3-517a-402f-add0-04eb072cf8a0',
    'x-owa-owsversion': 'V2018_01_18',
    'content-length': '9015',
    'x-backend-begin': '2019-12-19T01:39:46.963',
    'x-ua-compatible': 'IE=EmulateIE7',
    server: 'Microsoft-IIS/10.0',
    'strict-transport-security':
'max-age=31536000; includeSubDomains, max-age=31536000; includeSubDomains',
'x-owa-diagnosticsinfo': '46;4;0',
    'x-ms-appid': '00000002-0000-0ff1-ce00-000000000000' };
(async () => {
    // OPTION 1 - Launch new.
    /**const browser = await puppeteer.launch({
        headless: false // Puppeteer is 'headless' by default.
    });**/

        // OPTION 2 - Connect to existing.
        // MAC: /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222 --no-first-run --no-default-browser-check --user-data-dir=$(mktemp -d -t 'chrome-remote_data_dir')
        // PC: start chrome.exe â€“remote-debugging-port=9222
        // Note: this url changes each time the command is run.
    const wsChromeEndpointUrl = 'ws://127.0.0.1:9222/devtools/page/24A16256AECA55B86D8EB0D6E9A29DD1';
    const browser = await puppeteer.connect({
        browserWSEndpoint: wsChromeEndpointUrl
    });

    const page = await browser.newPage();
    await page.emulate(puppeteer.devices['iPhone X']);
    await page.setRequestInterception(true);
     page.on('response', (response) => {
         if (response._url.includes("userbootsettings")){
        {
            console.log(response);
        }}
    });
    page.on('request', request => {
        if (request._url.includes("userbootsettings")){
            const body = `{"cdnSettings":{"BackupBaseUrl":"//owassets.azureedge.net/owamail/","ExtraSettings":"","PackageBaseUrl":"//ow2.res.office365.com/owamail/","ResourcesPath":"resources/","ScriptPath":"scripts/"},"culture":"en-IN","currentEpochInMs":1576715564000,"features":["ADDIN-CENTERALIGNEDICSENABLED","ADDIN-COMPLIANCEVERIFICATION","ADDIN-GETACCESSTOKENASYNC-API","ADDIN-INCLIENTSTOREDEFAULTADDINSENABLED","ADDIN-INCLIENTSTOREENABLED","ADDIN-INCLIENTSTOREPINNABLEEXPERIENCE","ADDIN-INCLIENTSTOREPINNABLEEXPERIENCEENABLED","ADDIN-INCLIENTSTORESENDFEEDBACKENABLED","ADDIN-ITEMSENDEVENT","ADDIN-LAUNCHDATAPOINT","ADDIN-OTELJS","ADDIN-PERSISTENTTASKPANE","ADDINS-LAUNCHADDINSFROMURL","AN-CLIENT-ERROR","AN-NO-SAMPLE-PPE","AUTH-ACTIVITYFEED","AUTH-CUTOVERSOFTLANDING","AUTH-FORWARDINGNOTICE","AUTH-MOBILEDEVICE","AUTH-OPENANOTHERMAILBOX","AUTH-PREMIUMDASHBOARD","AUTH-SAFELINKSOPTIONCONTROL","AUTH-SERVICEWORKEREDGE","AUTH-SERVICEWORKERSAFARI","CAL-ADDCALENDARFROMDIRECTORY","CAL-ADDINS","CAL-ADVANCEDROOMBOOKING","CAL-AGENDA","CAL-AGENDAMAIL-FEEDBACK","CAL-AUTOMATIC-REPLIES","CAL-BIRTHDAY-SETTINGS","CAL-CACHEDIAGNOSTIC","CAL-CACHEDIAGNOSTICS","CAL-CALENDARDAYLISTCOMPONENT","CAL-CATEGORIES","CAL-EVENT-INVITATION-SETTING","CAL-FORMCATEGORIES","CAL-FULLCOMPOSE","CAL-GROUPSCALENDAR","CAL-HIGHLIGHTPASTDAYS","CAL-ICS-PREVIEW","CAL-IGNORESKIPSENDINGMEETINGINVITETOGROUP","CAL-INTERESTINGCALENDAR","CAL-LINKEDCALENDARENTRY","CAL-LOCATIONCARD","CAL-MAILTIPS","CAL-MEETINGMESSAGECONFLICTS","CAL-MF-AGENDAMAILOPTION","CAL-MF-ALLOWEDONLINEMEETINGPROVIDERS","CAL-MF-AUTOMATIC-REPLIES-NOTIFICATION","CAL-MF-AVAILABILITYFORRECURRENCE","CAL-MF-DEFAULTROOMSFROMLASINROOMPANEL","CAL-MF-DIAGNOSTICS","CAL-MF-DUPLICATEEVENT","CAL-MF-EMAILREMINDERS","CAL-MF-GROUPATTENDEES","CAL-MF-HIDEATTENDEELIST","CAL-MF-LOCATIONBUSYCONFIRMATION","CAL-MF-LOCATIONCOMMONWELL","CAL-MF-LOCATIONWELLSHOWFREEBUSY","CAL-MF-POPOUTREADFORM","CAL-MF-PROPOSENEWTIME","CAL-MF-RECIPIENTWELL","CAL-MF-RECIPIENTWELLBELOWTIMEINQC","CAL-MF-REQUESTONLYFREEROOMSFORZEROQUERY","CAL-MF-SUGGESTIONS","CAL-MF-TIMESUGGESTIONS","CAL-MF-USEFINDMEETINGLOCATIONS","CAL-MF-USETENANTSEARCH","CAL-NOTIFICATIONS-EXPANDCALENDAREVENT","CAL-PERSONALBOOKINGPAGE","CAL-PPF-CELEBRATION","CAL-PRINT","CAL-PUBLISHING-SETTINGS","CAL-RECURRENCETHISDATEFORWARD","CAL-RELATEDCONTENT","CAL-RELATEDCONTENT-FILESANDEMAILSUX","CAL-SEA-ADDCALENDARQUICKACTION","CAL-SEA-CLIENTSIDE","CAL-SEA-CONTEXTFEEDBACK","CAL-SEA-HISTORYQF","CAL-SEA-PEOPLEQF","CAL-SEA-QF-HISTORY-PEOPLE","CAL-SEA-QUERY","CAL-SHARING","CAL-SHARING-SETTINGS","CAL-SPLITVIEW","CAL-STICKYNOTESFOLDER","CAL-SURFACE-BOLDCOLORTHEME","CAL-SURFACE-DISCOVER-CALENDARS-EXPERIMENT","CAL-SURFACE-NOTIFICATIONBAR","CAL-SURFACE-REFRESH","CAL-SURVEYCANCELMEETBUCKET","CAL-SURVEYCREATEAPPTBUCKET","CAL-SURVEYCREATEMEETBUCKET","CAL-SURVEYUPDATEAPPTBUCKET","CAL-SURVEYUPDATEMEETBUCKET","CAL-SURVEYVIEWEVENTBUCKET","CAL-TXP-ACTIONS","CAL-TXP-DINING","CAL-TXP-EMAILDONATION","CAL-TXP-INFERENCESDSAT","CAL-TXP-MAIL","CAL-TXP-OPTIONSV2","CAL-TXP-READFORM","CAL-TXP-TEEDONATION","CAL-TXP-VISUALREFRESH","CAL-USEDEFAULTMEETINGPROVIDER","CAL-WEATHER-ADDLOCATIONS","CMP-ACCCHECKER","CMP-BLOCKQUOTE","CMP-DARKMODE","CMP-DARKMODETOGGLE","CMP-DIRECTPASTE","CMP-DLEXPANDPERF","CMP-EDITORBLOCKQUOTE","CMP-ENCRYPTION","CMP-FABRICRECIPIENTWELL","CMP-FORMATPAINTER","CMP-LOADMOREDATAZONEBETA","CMP-MAILTIPS","CMP-MENTIONS","CMP-MUTATIONOBSERVERREACTEDITORIE11","CMP-NEWEMOJI-PLUGIN","CMP-NEWMENTIONPLUGIN","CMP-PASTEOPTION","CMP-QUICKSWITCHER","CMP-SMARTLIST","CMP-SMIME","CMP-STICKYDOCKING","CMP-TABDRAGOVERARROW","CMP-UPGRADECOMPOSE","DOC-ATTACHMENT-CONVOWELL","DOC-ATTACHMENT-DOWNLOADDOMAIN","DOC-ATTACHMENT-DUALENTRYPOINT","DOC-ATTACHMENT-DUALENTRYPOINTNEWCONTROL","DOC-ATTACHMENT-SLICEDCLASSICATTACHMENTUPLOAD","DOC-ATTACHMENT-THROTTLETHUMBNAILS","DOC-ATTACHMENT-UPSELLENTRYPOINT","DOC-FILEPICKER-MAILMESSAGEATTACHMENT","DOC-FILEPICKER-ONEDRIVECONSUMERFORO365","DOC-FILEPICKER-ONEDRIVEPROCLIENTCALLS","DOC-FILEPICKER-ONEDRIVEPRORECENTFILES","DOC-FILEPICKER-PRELOAD","DOC-FILEPICKER-RECENTATTACHMENTS","DOC-FILEPICKER-SHAREDWITHMEIMPROVEMENTS","DOC-FILEPICKER-THIRDPARTYPROVIDERCLIENTCALLS","DOC-FILEPICKER-V2","DOC-FILEPROVIDER-WOPICLIENT","DOC-FILESHUB","DOC-FILESHUB-SEARCHBOX","DOC-SHAREPOINT-DOGFOODUSER","DOC-SHAREPOINT-SERVICEGENERATEDLINKTELEMETRY","DOC-SHARINGTIPS-LINKREMOVE","DOC-SXS-ITEMATTACHMENT","DOC-SXS-JSAPI-ODB-EXCEL","DOC-SXS-JSAPI-ODB-POWERPOINT","DOC-SXS-JSAPI-ODB-WORD","DOC-SXS-PDFJSPREVIEW","DOC-SXS-PDFJSPREVIEWDEFAULTINEDGE","DOC-SXS-PDFJSPREVIEWDEFAULTINFIREFOX","DOC-SXS-PRINTIMAGE","DOC-SXS-PRINTPDF","DOC-SXS-V2","EXT-TIMEEXPRESSIONHIGHLIGHT","FEEDBACK-IDEAS-PANE","FWK-BATCHSUBSCRIPTIONS","FWK-BOOKINGSMODULE","FWK-COBRANDING","FWK-EMPTYPOST","FWK-ERRORHANDLERNONWRAPPED","FWK-FEEDBACKCHARM","FWK-GETALLOWEDOPTIONS","FWK-INAPPNOTIFICATIONS","FWK-LOCALEHOTRELOAD","FWK-LOGOWSACTIONOPTICS","FWK-LOGOWSACTIONOPTICS_V2","FWK-MODULESWITCHERREUSETABS","FWK-O365SHELLHEADER","FWK-OPTION-POPIMAP","FWK-PATCHSIGNALRGETURL","FWK-PATHBASEDROUTER","FWK-PEOPLEREACT","FWK-SKYPEBUSINESS","FWK-THEMES-EDU","FWK-WEBPUSHNOTIFICATION","GRP-CREATEGROUP","GRP-DISCOVERSEARCH","GRP-DISCOVERY-LEFTNAV","GRP-FILESHUB","GRP-FILESHUBREUSEATTACHMENTPREVIEW","GRP-GROUPFILESHUBFRE","GRP-GROUPHEADERV2","GRP-MANAGE-LEFTNAV","GRP-PREFETCHSPTOKENFROMCONVERSATIONS","GRP-PREVIEWATTACHMENTINSXSV2","GRP-PREVIEWSPFILEINNEWSXS","GRP-UNREADCOUNTTOP5ANDFAVORITES","GRP-WARMUPFREQUENTLYUSEDGROUPS","HELP-O365SHELLHEADER-MAXPANE","MC-CONFETTI","MC-DIVERSEEMOJIS","MC-EXPPICKER","MC-IMAGESXS","MC-LINKPREVIEW","MC-LOGMESSAGESINSPANISH","MC-MOVEATTACHMENTTOINLINE","MC-REPLYWITH","MC-REPLYWITH-SHOWUI","MC-REPLYWITHAA","MC-REPLYWITHMRUCLASSIC","MC-REPLYWITHNAMPRIME","MC-SMARTCOMPOSE","MC-SMARTPILLSFEEDBACKFORMV2","MC-SMARTPILLSMESSAGEVIEW","MC-SMARTREPLYAA","MC-SMARTREPLYAA2","MC-SMARTREPLYWITHCUSTOMMEETING","MC-USERHIGHLIGHTING","MC-VOTING","MINI-ATTACHMENT-PREVIEW","MINI-FEEDBACKDF","MINI-OUTLOOKFAVORITES","MINI-SERVICEWORKER","PEO-EV-HEADER","PEO-EXPERIENCES","PEO-FAVORITE-FAVORITECONTACTS","PEO-FAVORITE-USESEARCHONADD","PEO-FAVORITEPDLS","PEO-LOKIDOGFOOD","PEO-LPCTARGETV2ONPERSONACARDBEHAVIOR","PEO-UNAUTHENTICATEDSENDER","PEOPLE-APPCOMMANDBAR","PEOPLE-EMPTYFOLDER-BULK","PEOPLE-FAVORITEPICKER","PEOPLE-FAVORITEPICKERINCLUDEGROUPS","PEOPLE-GROUPSDEEPLINK","PEOPLE-GROUPSHUBREACT","PEOPLE-GROUPSPREFETCH","PEOPLE-INITIALGROUPSPREFETCH","PEOPLE-MAILCOMPOSEINSYNCWAY","PEOPLE-MOVECONTACT","PEOPLE-ORGNAVIGATION","PEOPLE-RENEWGROUP","PEOPLE-RESTOREDELETEDCONTACTS","PEOPLE-RESTOREDELETEDITEMSLEFTNAV","PEOPLE-RESTOREGROUP","PEOPLE-SEARCHDROPDOWN","PEOPLE-SUGGESTIONFOLDER","PF-FAVORITE","PF-PICKER","PF-PICKER-CALENDAR","PF-POST","RP-3SPEOPLESUGGESTIONS","RP-ACTIONABLEMESSAGE-AAD-TOKEN","RP-ACTIONABLEMESSAGES","RP-ACTIONABLEMESSAGES-AAD-TOKEN","RP-ACTIONABLEMESSAGES-MYANALYTICS","RP-ACTIONABLEMESSAGES-REMOTE-STYLES","RP-ACTUIBUBBLE","RP-ADAPTIVECARDSRECORDLINKS","RP-ADDINPINNING","RP-APPENDONSEND","RP-COLLAPSEDITEMSROLLUP","RP-CSAEXP","RP-CUSTOMSURFACEACTIONS","RP-FINDPEOPLESUGGESTIONFEEDBACK","RP-IMAGECONTENTHANDLER","RP-IMMERSIVEREADER","RP-IMMERSIVEREADERDOGFOOD","RP-IMMERSIVEREADERV2ENDPOINT","RP-INLINETRANSLATION","RP-LASTACTIONINFOBAR","RP-LIKE","RP-LOCALLIESENTTIME","RP-NEWTABLOOK","RP-OOFROLLUP","RP-OPAY-MODELB-ENDPOINT","RP-OUTLOOKADDINSDEEPLINK","RP-POPOUTS","RP-POPOUTSV2","RP-POPOUTWITHVERSION","RP-READRECEIPT","RP-REPLYBYMEETING","RP-REQUESTPERSONARESPONSESHAPE","RP-SELECTIONUI","RP-SMIME","RP-TABVIEW","RP-WIDECONTENT","SEA-3SGRIFFINV2","SEA-ADVANCED-SEARCH","SEA-CIRCLEPERSONAS","SEA-CLIENTHITHIGHLIGHT","SEA-CONTEXTFEEDBACK","SEA-CONVERSATION","SEA-EMAILSUGGESTIONS","SEA-EXPANDTHREAD","SEA-FILESSUGGESTIONS","SEA-FILESUGGESTIONAUGMENTATION","SEA-FLOODGATESURVEY","SEA-FLOODGATESURVEYSDFSAMPLING","SEA-GDPR","SEA-HIGHLIGHTATTACHMENTS","SEA-HYBRIDSEARCHSUPPORTED","SEA-OMITCOOKIES","SEA-PERSONACARDINSUGGESTIONS","SEA-PILLHIGHLIGHT","SEA-PREFIXHH","SEA-PROXY3SQUERY","SEA-QF","SEA-QUERYTEXTKQL","SEA-RESULTINSTRUMENTATION","SEA-SEARCHBOXINTERACTIONSCONTROL","SEA-SEARCHHISTORYAPI","SEA-SKIPOWSPRIME","SEA-SPELLINGCORRECTEDSEARCHNORESULTS","SEA-ZINQ-3S","TRI-ANCHORMAILBOXHEADER","TRI-ARCHIVE-MAILBOX","TRI-BULKACTIONNOTIFICATION","TRI-CATEGORIES-PARITY","TRI-COPYITEM","TRI-CUSTOMHOVERACTIONS","TRI-FAVORITEHEADER","TRI-FAVORITES-ROAMING","TRI-FAVORITESEARCH","TRI-FLAG-COMPLETE","TRI-FOCUSED-PIVOT","TRI-FOCUSED-STICKY-ROLLUP","TRI-FOLDERPERMISSIONS","TRI-IGNORE","TRI-LISTVIEWSELECTIONV2","TRI-MAILSORT","TRI-MESSAGELISTVIEW","TRI-MODULESWITCHERBEHAVIOR","TRI-MOVETOSWEEPOPTION","TRI-NONSUBSTRATEINFERENCE","TRI-NOTIFICATIONBAR","TRI-REPORTABUSE","TRI-RETENTIONPOLICIES","TRI-RULES-SIMPLE","TRI-SCROLLMOREDATAPOINT","TRI-SEARCHBACKSTACKING","TRI-SHAREDFOLDERS","TRI-SMARTMERGEFINDRESPONSE","TRI-SNOOZE","TRI-SPAMV2","TRI-SPAMV2SENDERDOMAIN","TRI-SUPERCONVERSATIONEXPANSION","TRI-SUPPRESSMARKREADBEHAVIORONRF","TRI-SWEEPBULKACTION","TRI-TURNOFFFOCUSEDOTHER","USV-FORUM","USV-NPS-5-RATING-SCALE","WHATSNEW-BOLDCALENDARCOLORS","WHATSNEW-FILESHUB","WHATSNEW-PANE","WHATSNEW-SCHEDULEATGLANCE","WHATSNEW-SMARTSEARCH","ring-dogfood","addin-delegateaccess","auth-calendar-serviceworker-cache","fwk-fluentfabric","tri-conversationview-foldertags","doc-filepicker-onedriveprorecentfiles","doc-filepicker-onedriveconsumerforo365","fwk-puidbasedrouting","auth-premiumtravelactivateramp","auth-premiumtravelupsellramp","cal-time-panel","tri-triagefolderscope","tri-automarkreadinunreadsetting","rp-showlinkedinbindingbtninpeoplepicker","cmp-smimeadminsettings","doc-attachment-contextualsharingtips","doc-sxs-commandbarstyleupdate","cal-relatedcontent-prefetch","rp-yammer","whatsnew-groupsrestorecard","doc-sxs-jsapi-odb-links","mc-smartpillconfidencelevel_low","inline-feature-feedback","tri-hovericonsui","people-grouprestoreongroupmailbox","auth-activityfeedatmentionsprocessor","tra-enableshortmessage","fwk-skypebusinessv2","cal-surface-refresh-addcalendar","cal-mf-readingpaneshyheader","cal-mf-meetingmessageconflictstimepanel","cal-addcalendar-teamsnap","doc-fileprovider-gdrive","auth-traveldashboardenabled","sea-querytextkql","rp-inlinetranslationautomatic","doc-attachment-urlencoderoutingkey","rp-inlinetranslationmanual","people-option-displayby","grp-suggestunifiedgroupmembers","mailto-group-forms","mini-automaticreplies","mini-markasjunkmultiselect","cal-mf-attendeebusyconfirmationfc","cal-mf-attendeebusyconfirmationqc","grp-echosuppressionoption","mc-smartpillsfeedbackform","cal-relatedcontent-filesandemailsux","tri-upnextv2","an-log-assets","cal-schoolcalendars","cmp-darkmodesimplerecolor","cal-mf-quickcomposemergedeventandoof","grp-shareable-crud","cal-multiaccounts","fwk-sigs","sea-suggestionbolding4","cal-mf-quickcomposemergedevent","tra-cachetranslation","tri-filtermenuredesign","people-publicfolders","auth-premiumtravelexp","auth-getaccesstokenqueueenabled","cal-mf-insightsinupnext","tri-pauseinbox","whatsnew-timepanel","cal-mf-resourceschedulingsetting","rp-optimizeautosearchdirectorycf","rp-inlinetranslation-feedbackribbon","rp-inlinetranslation-floodgatesurvey","notes-folder-view","fwk-devtools","tri-distributiongroupsoption","cal-mf-showroombookingcapabilities","mc-smartcomposefeedback","fwk-darkthemeextended","auth-authzheadernocookies","cal-trutime","auth-progressivewebapp","sea-naturallanguage","cal-groupnotifications","auth-mobiledevice","getstarted-messagelist","tri-fasterinboxrulesloader","rp-inlinetranslation-useows","fwk-prefetch-code-off-chromium","mini-tri-folder-collapse","mc-smartreplywithmeeting-suggestedtimetocas","cal-notificationdiagnostics","sea-prefixhh","cmp-message-classification","sea-findfromsender","mc-smarttask","people-groupsmailboxexport","mc-smartreplywithdoc","rp-csapinnedlikes","cal-sea-qf-people","cal-sea-qf-history","cal-pbp-addpsplinktosignature","getstarted-officecard","cmp-dictation","cal-mf-mailcalendarcard","fwk-option-userestcore","rp-inlinetranslation-conversationviewoff","fwk-fluentcommandbar","rp-3smasking","people-pdlsincommandbar","sea-answers-calendar","doc-attachment-forgottenattachments","cal-mf-enabledefaultonlinemeetingsetting","office-suite-nps","doc-sxs-wac-prefetchstaticresources","cal-mf-timeproposalui","doc-filepicker-storageaccountview","cal-sea-addcalendarquickaction","doc-attachment-listviewdragdrop","cal-mf-inlinecomposeintimepanel","cal-outlookmeetingpoll","cal-mf-newtimezonepicker","cal-mf-sendrewardsfortimesuggestions","cal-mf-insightsv2","cmp-galrecipientwellmodal","doc-link-sharecompose","doc-fileshub-sortmenu","cal-dnd-icsfile","doc-attachment-convowelldragdrop","tri-meetingmessagersvp","cal-mf-joinbutton","lpc-ispersonainsightringenabled","rp-inlinetranslationreportwronglanguagedebug","fwk-testpromotion1","getstarted-personalizationcard","doc-sxs-textpreviewencodingoptions","cal-time-panel-dragescalatemeeting","rp-inlinetranslation-targetlanguage","addin-officejs-v2","an-log-usermetrics","tri-nudge","cal-txp-unblock","people-directory-in-left-nav","rp-inlinetranslation-donatecontent","cal-surface-expandalldaywell","tri-runinboxrulesnow","fwk-webpushnotificationextended","cal-mf-removeteamsblobfrompeekpreview","doc-attachment-suggestedattsux1","tri-nudgefeedback","mini-uirefresh","mini-optoutfeedback","cmp-clp","sea-3squery","cal-txp-firstrunexperienceinvoice","cal-mf-calendarpicker","mini-people","sea-calendarsuggestions","tri-reportabusearisendpoint","cal-notifications-hideautoreplynotification","cmp-clp-auto-labeling","sea-personacardinsuggestions","cmp-inlinetranslation","auth-getdelegationtokenqueueenabled","whatsnew-inlinetranslationcard","cal-mf-outlookpollswssprocessor","lpc-aadlokitokens","mc-officeeditorbx","cmp-galsearch","cal-cachediagnostics","cal-mf-locationcommonwell","tri-copyitem","doc-fileshub-combinefilesandimages","cal-advancedroombooking","grp-manage-leftnav","people-groupsdeeplink","mc-smartreplywithcustommeeting","cal-cachediagnostic","cal-mf-rsvpmodel","people-emptyfolder-bulk","sea-searchhistoryapi","peo-unauthenticatedsender","cmp-darkmodetoggle","cal-personalbookingpage","cal-mf-hideattendeelist","cmp-darkmode","rp-inlinetranslation","mc-smartpillsfeedbackformv2","cal-txp-optionsv2","whatsnew-smartsearch","whatsnew-scheduleatglance","whatsnew-fileshub","grp-unreadcounttop5andfavorites","fwk-option-popimap","fwk-skypebusiness","auth-activityfeed","rp-localliesenttime","doc-sharepoint-servicegeneratedlinktelemetry","mc-replywith","rp-imagecontenthandler","whatsnew-boldcalendarcolors","cal-surface-boldcolortheme","grp-groupheaderv2","mc-smartcompose","cal-mf-proposenewtime","cal-mf-popoutreadform","people-suggestionfolder","cal-surface-discover-calendars-experiment","cal-ignoreskipsendingmeetinginvitetogroup","people-favoritepickerincludegroups","tri-suppressmarkreadbehavioronrf","addin-itemsendevent","doc-sxs-jsapi-odb-powerpoint","doc-sxs-jsapi-odb-excel","doc-sxs-jsapi-odb-word","mini-outlookfavorites","cmp-smime","rp-smime","mc-smartreply","rp-selectionui","mc-voting","cal-stickynotesfolder","cal-mf-recipientwell","cal-mf-timesuggestions","fwk-batchsubscriptions","doc-fileprovider-wopiclient","cal-agenda","whatsnew-pane","fwk-logowsactionoptics_v2","auth-openanothermailbox","fwk-patchsignalrgeturl","fwk-themes-edu","cal-mf-agendamailoption","cal-birthday-settings","cmp-fabricrecipientwell","cal-publishing-settings","cal-surface-notificationbar","cal-weather-addlocations","cmp-mutationobserverreacteditorie11","rp-oofrollup","cal-highlightpastdays","mc-exppicker","cal-print","rp-actionablemessages-aad-token","cmp-accchecker","tri-notificationbar","tri-retentionpolicies","cal-addcalendarfromdirectory","cal-sea-clientside","cal-mf-allowedonlinemeetingproviders","cal-mf-emailreminders","fwk-getallowedoptions","people-groupsprefetch","tri-scrollmoredatapoint","addin-getaccesstokenasync-api","fwk-o365shellheader","cal-mf-recipientwellbelowtimeinqc","tri-flag-complete","mc-logmessagesinspanish","help-o365shellheader-maxpane","rp-popoutwithversion","addin-inclientstorepinnableexperience","cal-addcalendar-google","peo-favoritepdls","cmp-newemoji-plugin","pf-picker-calendar","mini-attachment-preview","addin-oteljs","pf-picker","pf-post","pf-favorite","cal-sea-peopleqf","cal-mf-groupattendees","cal-mf-automatic-replies-notification","people-initialgroupsprefetch","grp-warmupfrequentlyusedgroups","rp-collapseditemsrollup","cmp-dlexpandperf","people-restoredeleteditemsleftnav","sea-floodgatesurvey","cmp-newmentionplugin","grp-discovery-leftnav","rp-newtablook","cal-mf-duplicateevent","rp-replybymeeting","cal-mf-locationbusyconfirmation","addin-complianceverification","rp-readreceipt","rp-lastactioninfobar","tri-favoriteheader","tri-smartmergefindresponse","tri-archive-mailbox","rp-appendonsend","mc-replywith-showui","tri-spamv2","cmp-smartlist","rp-like","tri-favorites-roaming","grp-discoversearch","cmp-upgradecompose","cal-mf-usetenantsearch","cmp-loadmoredatazonebeta","grp-groupfileshubfre","doc-attachment-upsellentrypoint","cal-calendardaylistcomponent","tri-spamv2senderdomain","cal-linkedcalendarentry","mc-moveattachmenttoinline","rp-findpeoplesuggestionfeedback","cmp-quickswitcher","an-no-sample-ppe","cal-mf-diagnostics","people-mailcomposeinsyncway","rp-immersivereaderv2endpoint","cmp-logonframedropwhiletyping","cal-mailtips","cal-trutime-google","cmp-mailtips","cal-mf-requestonlyfreeroomsforzeroquery","cal-mf-suggestions","rp-popoutsv2","cal-locationcard","cal-mf-usefindmeetinglocations","peo-lpctargetv2onpersonacardbehavior","cal-meetinginsights","sea-skipowsprime","rp-actionablemessages-myanalytics","addin-centeralignedicsenabled","cal-ics-preview","people-movecontact","sea-ignitecentered","addin-inclientstoreenabled","cal-addins","addin-persistenttaskpane","rp-addins","cmp-galrecipientwellmodaldetails","rp-addinpinning","fwk-moduleswitcherreusetabs","people-restoregroup","people-appcommandbar","cal-groupscalendar","people-renewgroup","mini-serviceworker","auth-serviceworkersafari","auth-serviceworkeredge","mc-userhighlighting","sea-floodgatesurveysdfsampling","sea-contextfeedback","cal-recurrencethisdateforward","cal-surveycreateapptbucket","cal-surveyupdateapptbucket","cal-surveyvieweventbucket","cal-surveycreatemeetbucket","cal-surveycancelmeetbucket","cmp-encryption","rp-widecontent","rp-cardui","addin-launchdatapoint","mc-smartreplyaa2","cal-fullcompose","cal-formcategories","sea-filessuggestions","auth-safelinksoptioncontrol","people-searchdropdown","tri-anchormailboxheader","tri-sharedfolders","feedback-ideas-pane","cal-splitview","fwk-cobranding","cal-ppf-celebration","cal-txp-invoice","addin-inclientstorepinnableexperienceenabled","tri-movetosweepoption","cal-surface-refresh","tri-folderpermissions","grp-previewattachmentinsxsv2","addins-launchaddinsfromurl","addin-inclientstoresendfeedbackenabled","sea-emailsuggestions","rp-outlookaddinsdeeplink","tri-customhoveractions","rp-adaptivecardsrecordlinks","sea-filesuggestionaugmentation","fwk-darktheme","people-favoritepicker","sea-proxy3squery","rp-actionablemessages","people-groupshubreact","cal-categories","an-client-error","grp-prefetchsptokenfromconversations","grp-fileshub","grp-creategroup","cal-event-invitation-setting","tri-bulkactionnotification","cal-agendamail-feedback","doc-sharepoint-dogfooduser","cal-sea-contextfeedback","tri-ignore","sea-circlepersonas","sea-gdpr","mc-confetti","fwk-pathbasedrouter","rp-actuibubble","sea-3sgriffinv2","rp-opay-modelb-endpoint","doc-filepicker-v2","rp-actionablemessage-aad-token","cal-sharing-settings","cal-sharing","cmp-stickydocking","grp-previewspfileinnewsxs","cmp-pasteoption","tri-superconversationexpansion","doc-filepicker-mailmessageattachment","people-orgnavigation","ext-timeexpressionhighlight","cal-notifications-expandcalendarevent","cal-sea-query","doc-fileshub","tri-listviewselectionv2","fwk-errorhandlernonwrapped","cal-txp-emaildonation","cal-interestingcalendar","fwk-bookingsmodule","tri-categories-parity","fwk-feedbackcharm","peo-favorite-usesearchonadd","cmp-mentions","rp-customsurfaceactions","cal-automatic-replies","cmp-formatpainter","cmp-blockquote","peo-favorite-favoritecontacts","cmp-editorblockquote","cal-meetingmessageconflicts","fwk-localehotreload","peo-lokidogfood","fwk-peoplereact","tri-favoritesearch","doc-sxs-savetocloud","doc-sxs-printpdf","cmp-directpaste","sea-resultinstrumentation","fwk-nativeads-prebidturnofffanonfirefox","fwk-inappnotifications","mc-imagesxs","grp-fileshubreuseattachmentpreview","fwk-emptypost","auth-premiumdashboard","people-restoredeletedcontacts","fwk-logowsactionoptics","rp-requestpersonaresponseshape","rp-popouts","sea-qf","rp-tabview","peo-experiences","tri-nonsubstrateinference","rp-immersivereaderdogfood","notes-slate-editor","cal-mf-meetingpollcard","rp-linkedinviewprofile","cal-mf-availabilityforrecurrence","mc-smartcomposeshadowmode","tri-dynamiclayout","tri-reportabuse","testset11","cal-time-panel-softpin","cal-time-panel-combineddrop","rp-extendedcards","fwk-testitar","fwk-betterdiagnostics-panel","doc-fileshub-leftnavenhancement","cal-mf-enablehideattendeelistonsharedcalendar","cal-showjoinbuttoninsurfaceevents","todo-create-from-cm","cal-mf-hidejoininpeek","sea-qf-headers","cal-mf-locationwellshowfreebusy","fwk-betterdiagnostics-service","cal-sequentialupnext","woven-savetocloud-hovernocloud","people-rightclickmenu","inline-feedback-business-contentdonation","rp-inlinetranslationforwardcontent2","mc-votingv2","rp-extendedcardsitemview","mini-tapfeedback","fwk-tti-governor","cal-txp-b2","mini-campaign","auth-reportsignalrerror","mc-smartcomposepipelinev2","sea-donatequery","sea-settings","tri-newcategorycreation","doc-attachment-blockonsendpendingpermissions","mc-smartcomposebodysuggestions","sea-spellingcorrectedsearchnoresults","sea-trysuggestions","mini-peoplefolders","grp-shareable-crud-create1sec","mc-smartreplywithmeeting-cortana","sea-folderscope","sea-fetchonscroll1"],"isDarkModeTheme":true,"isRtl":false,"language":"en","minSuportedOwsVersion":"V2_6","serverOwsVersion":"V2018_01_18","skipBuilds":[],"theme":"base"}`;
            //console.log(request.response());
            /*request.respond({
                status: 200,
                headers,
                contentType: "text/html",
                body
            })*/
            request.continue();

    }});
    await page.goto('https://outlook-sdf.office.com/calendar/view/agenda');

    await page.setViewport({ width: 800, height: 600 });

    const selectors = [
        '.agenda-item-wrapper > .\_39X_PVzL95T7fWukXNVnlz:nth-child(2) > .content-67 > .\_2EEEDzJ7atJ31HxyKem6k3 > .DtoWAsuhXN5G0uaH6wgiG',
        '#CalendarReadingPane > div._23UwX4x2cdaw8-O3MtE29D._3kbdeemHllmmQpD6zxQ_7Q > div > section:nth-child(1) > div._3mDjwoWOE_vs8MxD9OM-yx._3OdJ788Z_Omy0XBkQRRAeJ > div._2BMR9H5I2aV_MB9CfXAmkY > button'
    ];
    selectors.reduce(async (result, selector)=>{
        await result;
        await page.waitForSelector(selector);
        return page.click(selector);
    }, Promise.resolve());
})();
